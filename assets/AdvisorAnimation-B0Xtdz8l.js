async function P(e,w,r,s){return new Promise(n=>{const a=new window.Image;a.src="Hand.png",a.onload=()=>{const y=a.width*.5,v=a.height*.5,o=500,h=200,l=1e3,m=700,d=performance.now(),t=w+100,u=r-100,p=w,g=r;function A($){const c=$-d;e.clearRect(0,0,s.width,s.height);let b=t,C=u;if(c<o){const i=c/o;b=t+(p-t)*i,C=u+(g-u)*i}else if(c<o+h)b=p,C=g;else{const i=Math.min(1,(c-o-h)/m);b=p+(t-p)*i,C=g+(u-g)*i}const f=Math.min(1,(c-o)/l);if(f<1&&c>=o)for(let i=0;i<5;i++){const H=18+28*f+i*12;e.save(),e.beginPath(),e.arc(w,r,H,0,2*Math.PI);const I=(360*(i/5)+360*f)%360;e.strokeStyle=`hsla(${I}, 95%, 55%, ${.85*(1-f)})`,e.lineWidth=5-i*1.2,e.globalAlpha=1*(1-f),e.shadowColor=`hsla(${I}, 95%, 65%, 0.8)`,e.shadowBlur=18,e.stroke(),e.restore()}e.save(),e.globalAlpha=1,e.drawImage(a,b,C-v,y,v),e.restore(),c<o+Math.max(l,h+m)?requestAnimationFrame(A):(e.clearRect(0,0,s.width,s.height),n())}requestAnimationFrame(A)}})}async function R(e,w){var v;const r=document.querySelector('div[style*="flex: 3"]');if(!r)return;const s=r.getBoundingClientRect();let n=document.getElementById("advisor-animation-overlay");n?(n.width=window.innerWidth,n.height=window.innerHeight):(n=document.createElement("canvas"),n.id="advisor-animation-overlay",n.width=window.innerWidth,n.height=window.innerHeight,n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.pointerEvents="none",n.style.width="100vw",n.style.height="100vh",n.style.zIndex="9999",document.body.appendChild(n));const a=n.getContext("2d");if(!a)return;let y=[];for(const o of w.countries){y.push(o.name),e.setClickedCountryNames(y);const h=document.getElementById("country-info-panel");if(h&&e.currentGame&&typeof e.currentGame.gameTurn=="number"){const t=e.currentGame.activePlayer.getCountryInfo(o,e.currentGame.gameTurn);h.innerHTML=`
        <div><b>Name:</b> ${t.name}</div>
        <div><b>Owner:</b> ${t.owner?t.owner.name:"None"}</div>
        <div><b>Income:</b> ${t.income!==void 0?t.income:"?"}</div>
        <div><b>Army:</b> ${t.army!==void 0?t.army:"?"}</div>
        <div><b>Recency:</b> ${t.recency!==void 0?t.recency:"?"}</div>
      `}let[l,m]=o.center();const d=r.querySelector("canvas");if(d){const t=d.clientWidth/d.width,u=d.clientHeight/d.height;l*=t,m*=u}l+=s.left,m+=s.top,await P(a,l,m,n),a.clearRect(0,0,n.width,n.height)}e.setClickedCountryNames(y),e.updateActionButtons(),(v=n.parentElement)==null||v.removeChild(n)}export{R as runAdvisorAnimation};
