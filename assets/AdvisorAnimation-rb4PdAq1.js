async function P(e,y,r,s){return new Promise(n=>{const a=new window.Image;a.src="Hand.png",a.onload=()=>{const v=a.width*.5,f=a.height*.5,i=500,h=200,l=1e3,m=700,d=performance.now(),t=y+100,u=r-100,g=y,b=r;function I(H){const c=H-d;e.clearRect(0,0,s.width,s.height);let A=t,C=u,w=1;if(c<i){const o=c/i;A=t+(g-t)*o,C=u+(b-u)*o,w=o}else if(c<i+h)A=g,C=b,w=1;else{const o=Math.min(1,(c-i-h)/m);A=g+(t-g)*o,C=b+(u-b)*o,w=1-o}w=Math.max(.01,Math.min(1,w));const p=Math.min(1,(c-i)/l);if(p<1&&c>=i)for(let o=0;o<5;o++){const M=18+28*p+o*12;e.save(),e.beginPath(),e.arc(y,r,M,0,2*Math.PI);const $=(360*(o/5)+360*p)%360;e.strokeStyle=`hsla(${$}, 95%, 55%, ${.85*(1-p)})`,e.lineWidth=5-o*1.2,e.globalAlpha=1*(1-p),e.shadowColor=`hsla(${$}, 95%, 65%, 0.8)`,e.shadowBlur=18,e.stroke(),e.restore()}e.save(),e.globalAlpha=w,e.drawImage(a,A,C-f,v,f),e.restore(),c<i+Math.max(l,h+m)?requestAnimationFrame(I):(e.clearRect(0,0,s.width,s.height),n())}requestAnimationFrame(I)}})}async function R(e,y){var f;const r=document.querySelector('div[style*="flex: 3"]');if(!r)return;const s=r.getBoundingClientRect();let n=document.getElementById("advisor-animation-overlay");n?(n.width=window.innerWidth,n.height=window.innerHeight):(n=document.createElement("canvas"),n.id="advisor-animation-overlay",n.width=window.innerWidth,n.height=window.innerHeight,n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.pointerEvents="none",n.style.width="100vw",n.style.height="100vh",n.style.zIndex="9999",document.body.appendChild(n));const a=n.getContext("2d");if(!a)return;let v=[];for(const i of y.countries){v.push(i.name),e.setClickedCountryNames(v);const h=document.getElementById("country-info-panel");if(h&&e.currentGame&&typeof e.currentGame.gameTurn=="number"){const t=e.currentGame.activePlayer.getCountryInfo(i,e.currentGame.gameTurn);h.innerHTML=`
        <div><b>Name:</b> ${t.name}</div>
        <div><b>Owner:</b> ${t.owner?t.owner.name:"None"}</div>
        <div><b>Income:</b> ${t.income!==void 0?t.income:"?"}</div>
        <div><b>Army:</b> ${t.army!==void 0?t.army:"?"}</div>
        <div><b>Recency:</b> ${t.recency!==void 0?t.recency:"?"}</div>
      `}let[l,m]=i.center();const d=r.querySelector("canvas");if(d){const t=d.clientWidth/d.width,u=d.clientHeight/d.height;l*=t,m*=u}l+=s.left,m+=s.top,await P(a,l,m,n),a.clearRect(0,0,n.width,n.height)}e.setClickedCountryNames(v),e.updateActionButtons(),(f=n.parentElement)==null||f.removeChild(n)}export{R as runAdvisorAnimation};
